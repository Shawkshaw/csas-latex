%% resDocSty.sty - Unoffocial LaTeX style file for Canadian
%%  Science Advisory Secretariat Research Documents.
%% Authors:
%% Andrew Edwards
%% Rowan Haigh
%% Chris Grandin

%% Notes on installing a package when the MikTex servers are down:
%% Go to CTAN and get your package. Unzip, and mvoe contents to:
%% C:Program Files/MiKTeX 2.6/tex/latex/PACKAGE_NAME where
%%  PACKAGE_NAME is whatever the name of the package you are
%%  installing is. In this directory, there are files called
%%  .dtx and .ins files. Run this on a command line:
%%   latex PACKAGE_NAME.ins
%%  which will create the .sty files from the .ins files.
%%  Now you have to refresh FNDB:
%% Go to Start->Programs->Maintenance(Admin)->MikTex Settings(Admin)

%% Notes on installing the required Arial font:
%% Make a empty directory called C:\texlocal
%% Go to this URL:
%% http://mirrors.ctan.org/install/fonts/urw/arial.tds.zip
%% Download the TDS-compliant zip and unzip into C:\texlocal
%% The directory should contain three subdirectories: doc, fonts, and tex.
%% Be sure that the directory under `fonts' includes `type1' not `type' (rename if necesary)
%% Go to Start->Programs->Maintenance(Admin)->MikTex Settings(Admin)
%%  - Go to the Roots tab
%%  - Click `Add' and add C:\texlocal
%%  - Go to `General' tab
%%  - Click `Refresh FNDB' button
%%  - Click `Update Formats' button
%% Open a command line:
%%  - Run the following command:
%%     initexmf --edit-config-file updmap
%%  - Insert the following line:
%%     Map ua1.map
%%  - Save the file and close the editor.
%%  - Run the following command to rebuild the font map files:
%%     initexmf --mkmaps
%% ------------------------------------------------------------------------------

%% ------------------------------------------------------------------------------
%% Use the resDoc.bst file for bibliography style.
\usepackage{natbib}
\usepackage[breaklinks=true,
            bookmarksopen=true,
            bookmarksdepth=3]
           {hyperref}
\hypersetup{colorlinks,
            plainpages=true,
            linkcolor=black,
            citecolor=black,
            urlcolor=blue,
            bookmarksopen=true,
            bookmarksopenlevel=1}
%% ------------------------------------------------------------------------------

%% For fleqn
\usepackage{nccmath}
%% If you want to add line numbers in
\usepackage[pagewise]
           {lineno}
\usepackage[top=1in,
            bottom=1in,
            left=1in,
            right=1in]
           {geometry}

%% To add in headers and footers
\usepackage{fancyhdr}
\usepackage[format=plain,
            indention=0cm,
            labelsep=period,
            font={small, it},
            justification=raggedright,
            singlelinecheck=false]
           {caption}

%% ------------------------------------------------------------------------------
%% Table of Contents
\usepackage{tocloft}
%% Enable dots for chapters in the TOC
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}
%% Un-bold the chapter text in the TOC
\renewcommand{\cftchapfont}{\mdseries}
%% Un-bold the chapter page numbers in the TOC
\renewcommand{\cftchappagefont}{\mdseries}
%% Make the chapter entries the same indentation as the sections (entry,indent,numWidth)
%% See the tocloft documentation to get these values
\cftsetindents{chapter}{1.5em}{2.3em}
%% Make vertical spacing between chapter entries in TOC = zero.
\setlength{\cftbeforechapskip}{0pt}
%% ------------------------------------------------------------------------------

\captionsetup[table]{position=above, skip=5pt}
%% To have less whitespace after Table
%%  caption. 'above' tells it to put the
%%  skip after caption, but you may still
%%  need to have the caption before
%%  the table in .tex.
\usepackage{epsfig}   %% for epsfbox
\usepackage{graphicx} %% for \includegraphics (eps and others)

%% For ragged right margins (yes, ugly,
%%  but that's the rules, which of course
%%  exist because right justified in Word
%%  always looks so bad).
\raggedright
\raggedbottom
%% I had also tried the newer \RaggedRight
%%   from the ragged2e package, but it
%%   seems to introduce lots of hyphens.
%% \usepackage{ragged2e}   %% For RaggedRight which is apparently
%%  a better word-breaking algorithm,
%%  (raggedright tries to avoid hyphens).
%% You actually need the ms package (Martin
%%  Schroeder), as ragged2e calls others.
%% \RaggedRight

%% Headers and footers - see \lhead etc. at the start of .tex
\pagestyle{fancy}
\renewcommand{\footrulewidth}
  {0.4pt}
\renewcommand{\headrulewidth}
  {0.4pt}
%% For Res Doc, best to have a left and a right footer (header), not
%%  just one (for double-sided printing). Though I remember from my
%%  thesis there's a way to make it a header always be on the
%%  'outside' corner, so have a Google around.

%% To not indent paragraphs.
\setlength\parindent{0pt}
%% To increase white space between paragraphs (since not indenting).
\parskip 2ex

%% contraction after 'fake' subsubheading
\def\headc{\vspace{-2ex}}
%% Fake subsubsubheading
\def\subsubsub#1{\vspace{1ex} \noindent {\underline{#1}} \vspace{1ex}}

%% From Rowan, and see resDocSty-rh.sty for his settings using pt.
%% http://tex.stackexchange.com/questions/64756/what-is-glue-stretching
%% In TeX any glue is composed by a fixed part, a stretchable part and a
%%  shrinkable part. Each of these parts can be zero.
%% The general form to express a glue is: <fixed part> plus <stretchable part>
%%  minus <shrinkable part>. Each of these parts can be expressed in any of TeX
%%  units (mm, cm, pt, em, etc.). For example 2cm plus 2mm minus 1mm.

%% ------------------------------------------------------------------------------
%% Section and Chapter commands which match the CSAS template guide.
%% http://help-csli.stanford.edu/tex/latex-sections.shtml#section
%% http://zoonek.free.fr/LaTeX/LaTeX_samples_section/0.html
%% Font sizes I think will actually be 10.95pt
%%   for normal and 11.75pt for \large, according to the table in
%% http://en.wikibooks.org/wiki/LaTeX/Formatting#Sizing_text
\makeatletter
%% These two commands are required to use Arial for the document.
\renewcommand{\rmdefault}{phv}
\renewcommand{\sfdefault}{phv}

\newcommand{\nonumsection}{\@startsection
{section}{1}{0mm}                 %% name, level, indent
{-3.5ex \@plus -1ex \@minus -.2ex}%% beforeskip
{2.3ex \@plus.2ex}                %% afterskip
{\centering\normalfont\large\bfseries\MakeUppercase}}

\renewcommand{\section}{\@startsection
{section}{1}{0mm}
{-3.5ex \@plus -1ex \@minus -.2ex}
{2.3ex \@plus.2ex}
{\centering\normalfont\large\bfseries\MakeUppercase}}

\renewcommand{\subsection}{\@startsection
{subsection}{2}{0mm}
{-3.25ex plus -1ex minus  -.2ex}{1.5ex plus .2ex}
%% {1ex}{0.1ex plus -2ex}
{\normalfont\bf\MakeUppercase}}

\renewcommand{\subsubsection}{\@startsection
{subsubsection}{3}{0mm}
{-2ex plus -1ex minus -.2ex}{1.5ex plus .2ex}
{\normalfont\bf}}

\renewcommand{\chapter}{\@startsection
{chapter}{1}{0mm}
{-3.5ex \@plus -1ex \@minus -.2ex}
{2.3ex \@plus.2ex}
{\centering\normalfont\large\bfseries\MakeUppercase}}

%% Section headings in appendices must be left-justified not centered;
%%  this is same as \section above but without \centering
\newcommand{\appsection}{\@startsection
{section}{1}{0mm}                 %% name, level, indent
{-3.5ex \@plus -1ex \@minus -.2ex}%% beforeskip
{2.3ex \@plus.2ex}                %% afterskip
{\normalfont\large\bfseries\MakeUppercase}} %% style

\newcommand\TableOfContents{
  \thispagestyle{fancyplain}
  \pagenumbering{roman}
  %% TOC is required by CSAS to be on page iii.
  \setcounter{page}{3}
  \renewcommand{\contentsname}{\bf \large \vspace{-25mm} TABLE OF CONTENTS}
  \addtocontents{toc}{\protect\thispagestyle{fancy}}
  \begin{center}
    \tableofcontents
  \end{center}
  \newpage
  %% To number subsubheadings
  \setcounter{secnumdepth}{5}
}

\newcommand\Citation[1]{
  %% Start citation indentation
  \leftskip=3em
  \parindent=-3em
  {\bf Correct citation for this publication:}

  #1

  %% End citation indentation
  \leftskip=0em
  \parindent=-0em
}

\newcommand\Main{
  %% To number the main document sections, tables, etc.
  %%  as 1.1, 1.2, etc.
  \renewcommand{\thesection}{\arabic{section}.}
  \renewcommand{\thesubsection}{\arabic{section}.\arabic{subsection}}
  \renewcommand{\thesubsubsection}{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}}
  \renewcommand{\thetable}{\arabic{table}}
  \renewcommand{\thefigure}{\arabic{figure}}
  \renewcommand{\theequation}{\arabic{equation}}
}

\newcommand\Appendices{
  %% Start appendices. Sets up numbering for appendix sections
  %%  and their contents (tables, figures) to look like:
  %%  A.1, A.2, A.1.2
  \appendix
  %% Always start a new page for appendices
  \newpage
  \renewcommand{\thesection}{\thechapter.\arabic{section}}
  \renewcommand{\thesubsection}{\thechapter.\arabic{section}.\arabic{subsection}}
  \renewcommand{\thesubsubsection}{\thechapter.\arabic{section}.\arabic{subsection}.\arabic{subsubsection}}
  \renewcommand{\thetable}{\thechapter.\arabic{table}}
  \renewcommand{\thefigure}{\thechapter.\arabic{figure}}
  \renewcommand{\theequation}{\thechapter.\arabic{equation}}
  %% Set up Appendices in the TOC to not show subsections
  \addtocontents{toc}{\protect\setcounter{tocdepth}{0}}
  %% Set up first Appendix heading value
  \setcounter{chapter}{0}
}

%% Changes the name of the bibliography to REFERENCES.
\renewcommand{\bibname}{REFERENCES}
%% To make REFERENCES a section and then number it
\renewcommand{\bibsection}{\section{\bibname}}

%% Makes figures stick to the top of the page. i.e. if there is a single figure
%%  on a page, it will be placed in the center. This forces it to stick to the top.
\setlength\@fptop{0pt}
\makeatother
%% ------------------------------------------------------------------------------

%% ------------------------------------------------------------------------------
%% Defines the header and footer rules for a CSAS paper.
\fancypagestyle{csapfancy}{%%
  %% \fancyhead[L]{}%%{DRAFT -- Non-citable working paper}
  %% \fancyhead[R]{}%%{CSAP WP2016zzzxx}
  %% \fancyfoot[L]{}%%{Appendix \thechapter -- Model Results}
  %% \fancyfoot[R]{}%%{\Sexpr{paste0(sppname," (",area.name,")")}}
  \fancyfoot[C]{\thepage}
  \renewcommand{\headrulewidth}
    {0.4pt}
  \renewcommand{\footrulewidth}
    {0.4pt}
}
%% ------------------------------------------------------------------------------

%% ------------------------------------------------------------------------------
%% For landscape pages.
%% To do it properly, i.e. top and bottom lines and page number also rotated to
%%  landscape, do this:
%% \newgeometry{hmargin=1in,vmargin=1in}
%% \thispagestyle{csaplscape}
%% \pagestyle{csaplscape}
%% \begin{landscape}
%%   \centering
%%
%% Table code here, or knitr code chunk which prints an xtable.
%%
%% \end{landscape}
%% \restoregeometry
%% \pagestyle{csapfancy}

\usepackage{pdflscape}
\usepackage[absolute]{textpos}
\setlength{\TPHorizModule}
  {8.5in}
\setlength{\TPVertModule}
  {11.0in}
\fancypagestyle{csaplscape}{
  %% clear all header and footer fields
  \fancyhf{}
  \fancyfoot{}%%
  \begin{textblock}
    {1}(0.1,0.0909)
    {\rotatebox{90}
      {\rule{9in}{0.25pt}}
    }
  \end{textblock}
  \begin{textblock}
    {1}(0.9,0.0909)
    {\rotatebox{90}
      {\rule{9in}{0.25pt}}
    }
  \end{textblock}
  \begin{textblock}
    {0.05}(0.925,0.5)
    {\rotatebox{90}
      {\thepage}
    }
  \end{textblock}
  \renewcommand{\headrulewidth}
    {0pt} %% Get rid of lines along sides of landscape page
  \renewcommand{\footrulewidth}
    {0pt}
}
%% ------------------------------------------------------------------------------

%% ------------------------------------------------------------------------------
%% Indentation, types, and numbering of enumerated or bullet-point lists
\usepackage{enumerate}
%% These are done manually here -- doesn't perfectly flush left since
%%  need to allow space if you get up to double-digit enumeration. Is fine
%%  though.
\setlength{\leftmargini}{6mm}  %% not actually based on enumerate package
\setlength{\leftmarginii}{4mm} %%  (had already been done).
\setlength{\leftmarginiii}{4mm}
\setlength{\leftmarginiv}{4mm}

%% The following controls the look of the second-level in an enumeration list
\renewcommand{\labelenumii}{\theenumii}
%% This will make list items like 1.1, 1.2, etc
%%\renewcommand{\theenumii}{\theenumi.\arabic{enumii}.}
%% This will make list items like A., B., etc.
%%\renewcommand{\theenumii}{\Alph{enumii}.}
%% This will make list items like a., b., etc.
\renewcommand{\theenumii}{\alph{enumii}.}

%% The following controls the look of the second-level in an enumeration list
%% This will make list items circles instead of stars
\renewcommand{\labelitemii}{$\circ$}
%% Sets up the levels of lists with types to use for each,
%%  e.g. level 2 uses small alphabetic characters and
%%  level 3 uses roman numerals.
\usepackage{enumitem}
\newlist{longitem}{enumerate}{5}
\setlist[longitem,1]{label=\arabic*)}
\setlist[longitem,2]{label=\alph*)}
\setlist[longitem,3]{label=\roman*)}
\setlist[longitem,4]{label=\arabic*)}
\setlist[longitem,5]{label=\alph*)}
%% ------------------------------------------------------------------------------

%% ------------------------------------------------------------------------------
%% Included packages
\usepackage{cite}
%% Need array when specifying a ragged right column:
%%  >{\raggedright\arraybackslash}{p2in}.
\usepackage{longtable,array}
\usepackage{import}            % for figures in chapter subdirectories
\usepackage{graphicx}          % For inclusion of figures
\usepackage{verbatim,fancyvrb} % Check - may be in .sty file
\usepackage{xifthen}           % provides \ifthenelse and \isempty
\usepackage{color, colortbl}
\usepackage{arydshln}          % For dashed lines in tables (has to be loaded after other stuff)
\usepackage[parfill]{parskip}  % So paragraphs will have a blank line between them
\setlength{\parskip}{12pt}

% Use the following codes for references within the document.
%   chap: appendix
%    sec: section
% subsec: subsection
%    fig: figure
%    tab: table
%     eq: equation
%    lst: code listing
%    itm: enumerated list item
%    app: appendix subsection
\usepackage{hypcap}            % So links will anchor at figure, not caption
\usepackage{subfig}            % For two-panel plots
\usepackage{relsize}           % For mathlarger, which makes equations bigger
\usepackage{algorithm}         % For display of pseudocode
\usepackage{algpseudocode}     % For display of pseudocode
\usepackage{linegoal}          % For display of pseudocode
% A \Let command for defining assignments within the algorithmic environment which
% supports automatic indentation when the second argument is too long to fit
% on one line
\newcommand*{\Let}[2]{\State #1 $\gets$
\parbox[t]{\linegoal}{#2\strut}}
% A \State command that supports automatic indentation when the argument's
% content is too long to fit on one line
\newcommand*{\LongState}[1]{\State
\parbox[t]{\linegoal}{#1\strut}}
%% ------------------------------------------------------------------------------
